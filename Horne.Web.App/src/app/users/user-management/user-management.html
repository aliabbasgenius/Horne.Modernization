<section class="user-management">
	<mat-card appearance="outlined" class="toolbar-card">
		<div class="card-header">
			<div class="card-header-content">
				<h1>User Management</h1>
				<p>Maintain your modernization team with full control.</p>
			</div>
			<button mat-flat-button color="primary" type="button" (click)="createUser()">
				<mat-icon>person_add</mat-icon>
				Add user
			</button>
		</div>

		<mat-form-field appearance="outline" class="filter-field">
			<mat-label>Search users</mat-label>
			<input
				matInput
				placeholder="Search by name, email, role or status"
				[value]="filterValue()"
			(input)="applyFilter($any($event.target).value)"
			/>
			<button
				*ngIf="filterValue()"
				mat-icon-button
				matSuffix
				type="button"
				aria-label="Clear filter"
				(click)="clearFilter()"
			>
				<mat-icon>clear</mat-icon>
			</button>
		</mat-form-field>
	</mat-card>

	<mat-card appearance="outlined" class="table-card">
		<div class="table-wrapper">
			<table mat-table [dataSource]="dataSource" matSort>
				<ng-container matColumnDef="name">
					<th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
					<td mat-cell *matCellDef="let user">
						<span class="user-name">{{ user.name }}</span>
					</td>
				</ng-container>

				<ng-container matColumnDef="email">
					<th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
					<td mat-cell *matCellDef="let user" class="email-cell">
						<a href="mailto:{{ user.email }}">{{ user.email }}</a>
					</td>
				</ng-container>

				<ng-container matColumnDef="role">
					<th mat-header-cell *matHeaderCellDef mat-sort-header>Role</th>
					<td mat-cell *matCellDef="let user">{{ user.role }}</td>
				</ng-container>

				<ng-container matColumnDef="status">
					<th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
					<td mat-cell *matCellDef="let user">
						<mat-chip [color]="statusColor(user.status)" selected>
							{{ user.status }}
						</mat-chip>
					</td>
				</ng-container>

				<ng-container matColumnDef="lastActive">
					<th mat-header-cell *matHeaderCellDef mat-sort-header>Last Active</th>
					<td mat-cell *matCellDef="let user">{{ formatLastActive(user.lastActive) }}</td>
				</ng-container>

				<ng-container matColumnDef="actions">
					<th mat-header-cell *matHeaderCellDef class="actions-header">Actions</th>
					<td mat-cell *matCellDef="let user" class="actions-cell">
						<button
							mat-icon-button
							color="primary"
							type="button"
							matTooltip="Edit user"
							(click)="editUser(user)"
						>
							<mat-icon>edit</mat-icon>
						</button>
						<button
							mat-icon-button
							color="warn"
							type="button"
							matTooltip="Delete user"
							(click)="deleteUser(user)"
						>
							<mat-icon>delete</mat-icon>
						</button>
					</td>
				</ng-container>

				<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
				<tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
			</table>
		</div>
		<mat-paginator
			[pageSize]="5"
			[pageSizeOptions]="[5, 10, 25]"
			showFirstLastButtons
		></mat-paginator>
	</mat-card>
</section>
